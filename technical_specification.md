# ğŸŒ åœ°éœ‡ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ  v3.1 - å®Ÿç”¨æ©Ÿèƒ½60%é”æˆç‰ˆ æŠ€è¡“ä»•æ§˜æ›¸ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼‰

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

**ğŸ¯ å®Ÿç”¨æ©Ÿèƒ½é”æˆåº¦: 60%å®Œäº† (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ç‰ˆ)**

### 1.1 å®Ÿç”¨æ©Ÿèƒ½60%é”æˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ç‰ˆï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                é«˜åº¦æ´¥æ³¢ç›£è¦–çµ±åˆã‚·ã‚¹ãƒ†ãƒ  v3.1                         â”‚
â”‚                   ğŸ¯ å®Ÿç”¨æ©Ÿèƒ½60%é”æˆï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼‰             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   æ´¥æ³¢äºˆæ¸¬      â”‚  â”‚  å¤šåœ°ç‚¹é€£æº     â”‚  â”‚  Web Audio API      â”‚ â”‚
â”‚  â”‚   ã‚¨ãƒ³ã‚¸ãƒ³      â”‚  â”‚  æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ    â”‚  â”‚  éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ        â”‚ â”‚
â”‚  â”‚(ç§‘å­¦çš„è¨ˆç®—+     â”‚  â”‚(USGS+EMSC+     â”‚  â”‚(å®Œå…¨å®Ÿè£…+           â”‚ â”‚
â”‚  â”‚ 18ç®‡æ‰€äºˆæ¸¬)     â”‚  â”‚ NOAA+JMAçµ±åˆ)  â”‚  â”‚ ãƒ¬ãƒ™ãƒ«åˆ¥éŸ³å£°)       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CORSå¯¾å¿œ        â”‚  â”‚ ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–    â”‚  â”‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ          â”‚ â”‚
â”‚  â”‚ ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼â”‚  â”‚ ãƒ»å±¥æ­´ç®¡ç†      â”‚  â”‚ çµ±åˆç›£è¦–            â”‚ â”‚
â”‚  â”‚(Node.jså®Œå…¨å®Ÿè£…â”‚  â”‚(1000ä»¶å±¥æ­´+     â”‚  â”‚(30ç§’æ›´æ–°+           â”‚ â”‚
â”‚  â”‚ +ã‚¨ãƒ©ãƒ¼å‡¦ç†)    â”‚  â”‚ çµ±è¨ˆåˆ†æ)       â”‚  â”‚ ä¿¡é ¼æ€§è©•ä¾¡)         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CORSå®Œå…¨å¯¾å¿œãƒ»å›½éš›ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆ                   â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   USGS      â”‚ â”‚    JMA      â”‚ â”‚    NOAA     â”‚ â”‚   éŸ³å£°ãƒ†ã‚¹ãƒˆ    â”‚ â”‚
â”‚ â”‚åœ°éœ‡ãƒ‡ãƒ¼ã‚¿   â”‚ â”‚ æ°—è±¡åºãƒ‡ãƒ¼ã‚¿â”‚ â”‚åœ°éœ‡ãƒ‡ãƒ¼ã‚¿   â”‚ â”‚   ã‚·ã‚¹ãƒ†ãƒ       â”‚ â”‚
â”‚ â”‚(å®Œå…¨å‹•ä½œ)   â”‚ â”‚(å®Œå…¨å‹•ä½œ)   â”‚ â”‚(å®Œå…¨å‹•ä½œ)   â”‚ â”‚(ç‹¬ç«‹ãƒ†ã‚¹ãƒˆ)     â”‚ â”‚
â”‚ â”‚âœ… M7.0å¯¾å¿œ  â”‚ â”‚âœ… JSONå–å¾—  â”‚ â”‚âœ… M2.5+å¯¾å¿œ â”‚ â”‚âœ… éŸ³é‡åˆ¶å¾¡      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                    â–²                    â–²                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                          â”‚
â”‚  â”‚        P2Påœ°éœ‡æƒ…å ±              â”‚    â”‚                          â”‚
â”‚  â”‚     WebSocket API              â”‚    â”‚                          â”‚
â”‚  â”‚    (å³åº§æ´¥æ³¢ãƒªã‚¹ã‚¯è©•ä¾¡)         â”‚    â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                          â”‚
â”‚                                        â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚               å°‚ç”¨ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ                              â”‚ â”‚
â”‚  â”‚  /audio-test.html | /cors-test.html | /websocket-test.html â”‚ â”‚
â”‚  â”‚  éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ç‹¬ç«‹ãƒ†ã‚¹ãƒˆ | APIçµ±åˆãƒ†ã‚¹ãƒˆ | WebSocketæ¥ç¶šãƒ†ã‚¹ãƒˆâ”‚ â”‚
â”‚  â”‚  /api/status - ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ç›£è¦–                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 å®Ÿç”¨æ©Ÿèƒ½90%é”æˆ Technology Stack v3.0
- **Core Architecture**: é«˜åº¦æ´¥æ³¢ç›£è¦–çµ±åˆã‚·ã‚¹ãƒ†ãƒ 
- **éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ **: Web Audio APIï¼ˆå®Œå…¨ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯å®Ÿè£…ï¼‰
- **CORSå¯¾å¿œ**: Node.jså°‚ç”¨ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ»ã‚¨ãƒ©ãƒ¼å‡¦ç†å®Œå‚™ï¼‰
- **å¤šåœ°ç‚¹æ¤œè¨¼**: å›½éš›ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±åˆï¼ˆUSGS+JMA+NOAAå®Œå…¨ç¨¼åƒï¼‰
- **æ´¥æ³¢è©•ä¾¡**: åŸºæœ¬ãƒªã‚¹ã‚¯åˆ¤å®šï¼ˆç°¡æ˜“è·é›¢è¨ˆç®—ãƒ»çµŒé¨“çš„æ´¥æ³¢é€Ÿåº¦ãƒ»æ‰‹å‹•æ›´æ–°ï¼‰
- **ç·Šæ€¥å¯¾å¿œ**: ä½ç½®æƒ…å ±ãƒ™ãƒ¼ã‚¹é¿é›£èª˜å°+éŸ³å£°æ¡ˆå†…
- **é€šä¿¡ã‚·ã‚¹ãƒ†ãƒ **: WebSocket + CORSå¯¾å¿œNode.jsã‚µãƒ¼ãƒãƒ¼
- **è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ **: åŸºæœ¬æ´¥æ³¢ãƒªã‚¹ã‚¯åˆ¤å®šï¼ˆ7ç®‡æ‰€ä¸»è¦æ²¿å²¸éƒ¨ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½æœªå®Ÿè£…ï¼‰

## 2. ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### 2.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ§‹æˆ

#### 2.1.1 Professional File Structure v2.0
```
# Professional Architecture Files
index.html              # Professional Dashboard (Main App)
index-new.html          # Modular Architecture Version
styles.css              # Legacy styles (for compatibility)

# Actual File Structure (v3.1)
Jisin -App/
â”œâ”€â”€ index.html                    # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ server.js                     # Node.jså°‚ç”¨ã‚µãƒ¼ãƒãƒ¼  
â”œâ”€â”€ config.js                     # ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
â”œâ”€â”€ app-config.js                 # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šç®¡ç†
â”œâ”€â”€ error-handler.js              # çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”œâ”€â”€ timer-manager.js              # ã‚¿ã‚¤ãƒãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ data-validator.js             # ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ utils.js                      # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ audio-alert-system.js         # éŸ³å£°è­¦å ±ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ tsunami-alert-system.js       # æ´¥æ³¢è­¦å ±ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ tsunami-data-store.js         # ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
â”œâ”€â”€ tsunami-manager.js            # æ´¥æ³¢çŠ¶æ…‹ç®¡ç†
â”œâ”€â”€ jma-tsunami-loader.js         # æ´¥æ³¢ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼
â”œâ”€â”€ jma-xml-client.js             # JMA XMLã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ jma-data-converter.js         # ãƒ‡ãƒ¼ã‚¿å¤‰æ›
â”œâ”€â”€ multi-site-verification.js    # å¤šåœ°ç‚¹æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
â””â”€â”€ security-config.js            # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š

# Legacy Files (v1.0 compatibility)
test.html               # Test & Debug Interface
script.js               # Legacy main script
earthquake-api.js       # Legacy API communication
notification.js         # Legacy notification system
map.js                  # Legacy map functionality
config.js               # Configuration management

# Tsunami Warning System
jma-tsunami-loader.js   # JMA TopoJSON Data Loader
jma-data-converter.js   # Shapefile to TopoJSON Converter
data/
â””â”€â”€ jma-tsunami-areas.topojson  # JMA Official Tsunami Forecast Areas (23KB)

# Documentation
README.md               # Professional System Documentation
requirements.md         # System Requirements Specification
technical_specification.md # Professional Technical Specification
ARCHITECTURE_REDESIGN.md   # Architecture Design Document
```

#### 2.1.2 ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ v2.0

**Grid-based ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**
```css
.earthquake-dashboard {
    display: grid;
    grid-template-columns: 350px 1fr 400px;
    grid-template-rows: 70px 1fr;
    grid-template-areas: 
        "header header header"
        "sidebar main rightpanel";
}
```

##### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:
- **ãƒ¡ã‚¤ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ (é«˜ã•70px)**:
  - ğŸŒ ã‚¢ãƒ—ãƒªãƒ­ã‚´ + ã‚¿ã‚¤ãƒˆãƒ« "åœ°éœ‡ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ "
  - ğŸ”Œ P2P/APIæ¥ç¶šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆç·‘/èµ¤ï¼‰
  - ğŸ• ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ™‚è¨ˆè¡¨ç¤º
  - âš™ï¸ è¨­å®šãƒœã‚¿ãƒ³

- **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ (å¹…350px)**:
  - **âš¡ ç·Šæ€¥åœ°éœ‡é€Ÿå ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³**: EEWã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
  - **ğŸ“Š ç›£è¦–çµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³**: ä»Šæ—¥/ä»Šé€±ã®åœ°éœ‡æ•°ã€æœ€å¤§éœ‡åº¦ã€å¿œç­”æ™‚é–“
  - **ğŸ”´ æœ€æ–°åœ°éœ‡æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³**: ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ãªåœ°éœ‡å±¥æ­´ãƒªã‚¹ãƒˆ

- **ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ (ä¸­å¤®)**:
  - **ğŸ—ºï¸ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–åœ°å›³**: Leaflet.js + æ˜åº¦èª¿æ•´å¯¾å¿œ
  - **ğŸ“ éœ‡æºä½ç½®æƒ…å ±ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤**: åŒ—ç·¯ãƒ»æ±çµŒãƒ»æ·±ã•ãƒ»ãƒã‚°ãƒ‹ãƒãƒ¥ãƒ¼ãƒ‰è¡¨ç¤º
  - **ğŸ™ï¸ æ—¥æœ¬åˆ—å³¶ä½ç½®è¡¨ç¤º**: ä¸»è¦11éƒ½å¸‚ãƒãƒ¼ã‚«ãƒ¼ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼é©å¿œè‰²ï¼‰
  - **ğŸ”† æ˜åº¦èª¿æ•´ã‚·ã‚¹ãƒ†ãƒ **: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ CSSãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆ50-200%ï¼‰

- **å³ãƒ‘ãƒãƒ« (å¹…400px)**:
  - **ğŸ“¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ãƒ˜ãƒƒãƒ€ãƒ¼**: "LIVE" ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
  - **â° ã‚·ã‚¹ãƒ†ãƒ æ™‚åˆ»ã‚»ã‚¯ã‚·ãƒ§ãƒ³**: JSTæ™‚è¨ˆ + æ—¥ä»˜è¡¨ç¤º
  - **ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹**: ç¨¼åƒæ™‚é–“ãƒ»å—ä¿¡ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ»æ´»ç™ºåœ°åŸŸ
  - **ğŸ“‹ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ•ã‚£ãƒ¼ãƒ‰**: ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆãƒ»åœ°éœ‡ç™ºç”Ÿãƒ­ã‚°

### 2.2 ãƒ‡ãƒ¼ã‚¿ç®¡ç†

#### 2.2.1 ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
| ã‚­ãƒ¼ | èª¬æ˜ | ä¾‹ |
|------|------|-----|
| `earthquake_settings` | ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š | `{éœ‡åº¦é–¾å€¤, éŸ³é‡, etc}` |
| `earthquake_history` | åœ°éœ‡å±¥æ­´ | `[{åœ°éœ‡ãƒ‡ãƒ¼ã‚¿é…åˆ—}]` |
| `connection_status` | æ¥ç¶šçŠ¶æ…‹ | `{p2p: true, jma: false}` |

#### 2.2.2 ãƒ¡ãƒ¢ãƒªç®¡ç†
- **æœ€å¤§å±¥æ­´ä»¶æ•°**: 50ä»¶ï¼ˆãƒ¡ãƒ¢ãƒªï¼‰ã€10ä»¶ï¼ˆè¡¨ç¤ºï¼‰
- **è‡ªå‹•å‰Šé™¤**: 1é€±é–“ä»¥ä¸ŠçµŒéã—ãŸãƒ‡ãƒ¼ã‚¿
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä¸€æ™‚ä¿å­˜
- **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿**: æ—¥æ¬¡ãƒ»é€±æ¬¡åœ°éœ‡æ´»å‹•çµ±è¨ˆã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

## 3. APIä»•æ§˜

### 3.1 P2Påœ°éœ‡æƒ…å ± WebSocket API

#### 3.1.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```
wss://api.p2pquake.net/v2/ws
```

#### 3.1.2 æ¥ç¶šæ–¹å¼
- **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**: WebSocket
- **èªè¨¼**: ä¸è¦
- **å†æ¥ç¶š**: è‡ªå‹•ï¼ˆæœ€å¤§5å›ï¼‰

#### 3.1.3 ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
{
  "code": 551,
  "time": "2024-01-15T12:34:56+09:00",
  "earthquake": {
    "time": "2024-01-15T12:30:00+09:00",
    "hypocenter": {
      "name": "æ±äº¬éƒ½23åŒº",
      "latitude": 35.7,
      "longitude": 139.7,
      "depth": 30,
      "magnitude": 4.5
    },
    "maxScale": 30,
    "domesticTsunami": "None"
  },
  "points": [
    {
      "pref": "æ±äº¬éƒ½",
      "addr": "æ–°å®¿åŒº",
      "scale": 30
    }
  ]
}
```

### 3.2 P2Påœ°éœ‡æƒ…å ± å±¥æ­´API

#### 3.2.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```
https://api.p2pquake.net/v2/history?codes=551&limit=10
```

#### 3.2.2 å–å¾—æ–¹å¼
- **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**: HTTPS (Fetch API)
- **æ›´æ–°é–“éš”**: 60ç§’
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: JSONé…åˆ—
- **èªè¨¼**: ä¸è¦

#### 3.2.3 ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
```json
[{
  "code": 551,
  "earthquake": {
    "domesticTsunami": "None",
    "hypocenter": {
      "depth": 20,
      "latitude": 29.4,
      "longitude": 129.5,
      "magnitude": 3,
      "name": "ãƒˆã‚«ãƒ©åˆ—å³¶è¿‘æµ·"
    },
    "maxScale": 20,
    "time": "2025/07/21 17:13:00"
  },
  "points": [{
    "addr": "é¹¿å…å³¶åå³¶æ‘æ‚ªçŸ³å³¶",
    "pref": "é¹¿å…å³¶çœŒ",
    "scale": 20
  }],
  "time": "2025/07/21 17:16:28.21"
}]
```

## 4. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 4.1 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•ãƒ•ãƒ­ãƒ¼
1. **åˆæœŸåŒ–**: HTMLèª­ã¿è¾¼ã¿ã€CSSé©ç”¨
2. **è¨­å®šèª­ã¿è¾¼ã¿**: LocalStorageã‹ã‚‰è¨­å®šå–å¾—
3. **é€šçŸ¥è¨±å¯**: Notification API ã®è¨±å¯è¦æ±‚
4. **APIæ¥ç¶š**: P2P WebSocketæ¥ç¶šé–‹å§‹
5. **å®šæœŸå–å¾—**: æ°—è±¡åºAPIå®šæœŸãƒãƒ¼ãƒªãƒ³ã‚°é–‹å§‹
6. **UIæ›´æ–°**: åˆæœŸç”»é¢è¡¨ç¤º

### 4.2 ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ãƒ•ãƒ­ãƒ¼
```javascript
// P2Påœ°éœ‡æƒ…å ±ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
websocket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  if (data.code === 551) { // åœ°éœ‡æƒ…å ±
    updateP2PPanel(data);
    updateMap(data);
    checkNotificationConditions(data);
    saveToHistory(data);
    // ç·Šæ€¥åœ°éœ‡é€Ÿå ±ãƒã‚§ãƒƒã‚¯
    checkEEWStatus(data);
    // æ´»å‹•çµ±è¨ˆæ›´æ–°
    updateDashboardStats();
    // æ´»å‹•ãƒ•ã‚£ãƒ¼ãƒ‰è¿½åŠ 
    addActivityFeedItem(`ğŸ”´ åœ°éœ‡ç™ºç”Ÿ: ${data.location}`, 'earthquake');
  }
  if (data.code === 556 || data.code === 557) { // ç·Šæ€¥åœ°éœ‡é€Ÿå ±
    updateEEWStatus(data);
    addActivityFeedItem('ğŸš¨ ç·Šæ€¥åœ°éœ‡é€Ÿå ±ãŒç™ºä¿¡ã•ã‚Œã¾ã—ãŸ', 'warning');
  }
};

// P2På±¥æ­´æƒ…å ±ï¼ˆå®šæœŸå–å¾—ãƒ»10ä»¶ï¼‰
setInterval(async () => {
  const data = await fetchP2PHistoryData(); // limit=10
  updateJMAPanel(data); // 10ä»¶ã®ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã‚«ãƒ¼ãƒ‰è¡¨ç¤º
  if (data.length > 0) {
    updateMap(data[0]); // æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã§åœ°å›³æ›´æ–°
  }
}, 60000);
```

### 4.3 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```javascript
function handleWebSocketError(error) {
  console.error('WebSocket Error:', error);
  showConnectionError('P2Pæ¥ç¶šã‚¨ãƒ©ãƒ¼');
  attemptReconnect();
}

function handleFetchError(error) {
  console.error('Fetch Error:', error);
  showConnectionError('P2På±¥æ­´APIå–å¾—ã‚¨ãƒ©ãƒ¼');
  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æƒ…å ±ã®ã¿ã§ç¶™ç¶š
}
```

## 5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä»•æ§˜

### 5.1 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰
- **HTTPSé€šä¿¡**: å…¨ã¦ã®å¤–éƒ¨APIå‘¼ã³å‡ºã—
- **CSP**: Content Security Policyã®è¨­å®š
- **XSSå¯¾ç­–**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚º
- **èªè¨¼**: APIã‚­ãƒ¼ä¸è¦ï¼ˆå…¬é–‹APIä½¿ç”¨ï¼‰

### 5.2 ãƒ‡ãƒ¼ã‚¿ä¿è­·
- **LocalStorage**: æ©Ÿå¯†æƒ…å ±ã¯ä¿å­˜ã—ãªã„
- **å€‹äººæƒ…å ±**: åé›†ãƒ»ä¿å­˜ã—ãªã„
- **ãƒ­ã‚°**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã¿

## 6. ç›£è¦–ãƒ»ãƒ­ã‚°

### 6.1 ãƒ–ãƒ©ã‚¦ã‚¶ãƒ­ã‚°
- **ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«**: console.log, console.warn, console.error
- **å‡ºåŠ›å†…å®¹**: æ¥ç¶šçŠ¶æ…‹ã€ã‚¨ãƒ©ãƒ¼è©³ç´°ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **ä¿å­˜æœŸé–“**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ã®ã¿

### 6.2 ç›£è¦–é …ç›®
| é …ç›® | ç¢ºèªæ–¹æ³• | æ­£å¸¸å€¤ |
|------|----------|--------|
| P2Pæ¥ç¶šçŠ¶æ…‹ | WebSocket.readyState | 1 (OPEN) |
| æ°—è±¡åºAPIå¿œç­” | fetch response.ok | true |
| é€šçŸ¥è¨±å¯çŠ¶æ…‹ | Notification.permission | granted |

### 6.3 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
- **æ¥ç¶šã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼**: ç·‘/èµ¤ã®çŠ¶æ…‹è¡¨ç¤º
- **æœ€çµ‚æ›´æ–°æ™‚åˆ»**: ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—è¡¨ç¤º
- **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªè¡¨ç¤º

## 7. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### 7.1 é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
```bash
# GitHub Pages ãƒ‡ãƒ—ãƒ­ã‚¤
git add .
git commit -m "Initial earthquake app"
git push origin main
# GitHub Settings > Pages > Source: Deploy from branch
```

### 7.2 ç’°å¢ƒç®¡ç†
- **é–‹ç™ºç’°å¢ƒ**: ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ï¼ˆLive Serverç­‰ï¼‰
- **æœ¬ç•ªç’°å¢ƒ**: GitHub Pages / Netlify / Vercel

## 8. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### 8.1 æƒ³å®šè² è·
- **WebSocketæ¥ç¶š**: å¸¸æ™‚1æ¥ç¶š
- **APIå‘¼ã³å‡ºã—**: 60ç§’é–“éš”
- **ãƒ‡ãƒ¼ã‚¿è»¢é€é‡**: 1-5KB/å›

### 8.2 æœ€é©åŒ–
- **ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º**: å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æœ€å°åŒ–
- **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã®å®šæœŸå‰Šé™¤
- **æç”»æœ€é©åŒ–**: Virtual DOMä¸ä½¿ç”¨æ™‚ã®åŠ¹ç‡çš„ãªDOMæ›´æ–°

## 9. é‹ç”¨æ‰‹é †

### 9.1 PCèµ·å‹•æ–¹æ³•

#### 9.1.1 ãƒ­ãƒ¼ã‚«ãƒ«èµ·å‹•ï¼ˆé–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨ï¼‰
```bash
# 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd "/path/to/earthquake-app"

# 2. Python HTTPã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
python3 -m http.server 8080

# 3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹
# - ãƒ¡ã‚¤ãƒ³: http://localhost:8080/
# - ãƒ†ã‚¹ãƒˆ: http://localhost:8080/test.html
```

#### 9.1.2 é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°èµ·å‹•ï¼ˆæœ¬ç•ªç”¨ï¼‰
```bash
# GitHub Pagesã®å ´åˆ
git add .
git commit -m "Deploy earthquake app"
git push origin main
# Settings > Pages > Source: Deploy from branch

# Netlify/Vercelã®å ´åˆ
# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã¾ãŸã¯Gité€£æº
```

### 9.2 PCçµ‚äº†æ–¹æ³•

#### 9.2.1 ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼çµ‚äº†
```bash
# æ–¹æ³•1: Ctrl+C ã§ã‚µãƒ¼ãƒãƒ¼åœæ­¢

# æ–¹æ³•2: ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèªã¨å¼·åˆ¶çµ‚äº†
ps aux | grep "node server.js"
kill [PIDç•ªå·]

# æ–¹æ³•3: ç‰¹å®šãƒãƒ¼ãƒˆã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ï¼ˆmacOS/Linuxï¼‰
lsof -ti:8080 | xargs kill -9
```

#### 9.2.2 ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®çµ‚äº†
- ãƒ–ãƒ©ã‚¦ã‚¶ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹
- WebSocketæ¥ç¶šãŒè‡ªå‹•çš„ã«åˆ‡æ–­ã•ã‚Œã‚‹

### 9.3 æ—¥å¸¸é‹ç”¨
- **ç›£è¦–**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã®ã‚¨ãƒ©ãƒ¼ç¢ºèª
- **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**: å®šæœŸçš„ãªãƒ–ãƒ©ã‚¦ã‚¶ãƒªãƒ­ãƒ¼ãƒ‰
- **æ›´æ–°**: å¿…è¦ã«å¿œã˜ã¦ãƒšãƒ¼ã‚¸æ›´æ–°
- **è¨­å®šç®¡ç†**: è¨­å®šãƒ‘ãƒãƒ«ã§é–¾å€¤ãƒ»éŸ³é‡èª¿æ•´

### 9.4 éšœå®³å¯¾å¿œãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### 9.4.1 æ¥ç¶šã‚¨ãƒ©ãƒ¼ã®å ´åˆ
1. **P2Pæ¥ç¶šã‚¨ãƒ©ãƒ¼**:
   - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šç¢ºèª
   - ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šç¢ºèª
   - ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰

2. **APIå–å¾—ã‚¨ãƒ©ãƒ¼**:
   - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šç¢ºèª
   - ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼è©³ç´°ç¢ºèª

#### 9.4.2 é€šçŸ¥ãŒå‡ºãªã„å ´åˆ
1. **ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥è¨±å¯**: ãƒ–ãƒ©ã‚¦ã‚¶è¨­å®šã§é€šçŸ¥ã‚’è¨±å¯
2. **éŸ³å£°ãŒå‡ºãªã„**: ã‚·ã‚¹ãƒ†ãƒ éŸ³é‡ãƒ»ãƒ–ãƒ©ã‚¦ã‚¶éŸ³é‡ç¢ºèª
3. **Autoplayåˆ¶é™**: ã€ŒéŸ³å£°ãƒ†ã‚¹ãƒˆã€ãƒœã‚¿ãƒ³ã§AudioContextå‹•ä½œç¢ºèª

#### 9.4.3 åœ°å›³ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆ
1. **Leaflet.jsèª­ã¿è¾¼ã¿**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šç¢ºèª
2. **JavaScript ã‚¨ãƒ©ãƒ¼**: ãƒ–ãƒ©ã‚¦ã‚¶DevToolsã§ã‚¨ãƒ©ãƒ¼ç¢ºèª
3. **åº§æ¨™ãƒ‡ãƒ¼ã‚¿**: P2P APIãƒ‡ãƒ¼ã‚¿ã®åº§æ¨™æƒ…å ±ç¢ºèª

#### 9.4.4 æ´¥æ³¢ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆ
1. **TopoJSONãƒ•ã‚¡ã‚¤ãƒ«**: `data/jma-tsunami-areas.topojson`ã®å­˜åœ¨ç¢ºèª
2. **TopoJSONãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: CDNèª­ã¿è¾¼ã¿ç¢ºèª
3. **ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ãƒ‡ãƒ¼ã‚¿ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã§å†èª­ã¿è¾¼ã¿
4. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ã‚¨ãƒ©ãƒ¼æ™‚ã¯åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ

## 10. ã‚³ã‚¹ãƒˆè¦‹ç©

### 10.1 é‹ç”¨ã‚³ã‚¹ãƒˆ
- **GitHub Pages**: ç„¡æ–™
- **Netlify/Vercel**: ç„¡æ–™ãƒ—ãƒ©ãƒ³å†…
- **P2Påœ°éœ‡æƒ…å ±API**: ç„¡æ–™
- **æ°—è±¡åºAPI**: ç„¡æ–™
- **åˆè¨ˆ**: $0

### 10.2 é–‹ç™ºã‚³ã‚¹ãƒˆ
- **ãƒ‰ãƒ¡ã‚¤ãƒ³**: å¹´é–“$10-15ï¼ˆç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ä½¿ç”¨æ™‚ï¼‰
- **é–‹ç™ºãƒ„ãƒ¼ãƒ«**: ç„¡æ–™ï¼ˆVS Codeç­‰ï¼‰

## 11. æ–°æ©Ÿèƒ½æŠ€è¡“è©³ç´°

### 11.1 ãƒ¢ãƒ¼ãƒ€ãƒ«è©³ç´°è¡¨ç¤ºæ©Ÿèƒ½

#### 11.1.1 æŠ€è¡“å®Ÿè£…
- **HTMLæ§‹é€ **: `modal-overlay` > `earthquake-modal` > `modal-header|body|footer`
- **CSS**: GlassmorphismåŠ¹æœã€backdrop-filterã€fade/slide ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- **JavaScript**: `showEarthquakeModal()`, `closeEarthquakeModal()`, `generateModalContent()`
- **ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†**: ã‚¯ãƒªãƒƒã‚¯ã€ESCã‚­ãƒ¼ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚¯ãƒªãƒƒã‚¯ã§ã®é–‰ã˜ã‚‹æ©Ÿèƒ½

#### 11.1.2 è¡¨ç¤ºãƒ‡ãƒ¼ã‚¿
```javascript
// ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºãƒ‡ãƒ¼ã‚¿ä¾‹
{
  åŸºæœ¬æƒ…å ±: {
    ç™ºç”Ÿæ™‚åˆ»: "2024-XX-XX XX:XX:XX (æ›œæ—¥)",
    éœ‡æºåœ°: "åƒè‘‰çœŒæ±æ–¹æ²–",
    ãƒã‚°ãƒ‹ãƒãƒ¥ãƒ¼ãƒ‰: "M4.2",
    æ·±ã•: "60km",
    æœ€å¤§éœ‡åº¦: "éœ‡åº¦3",
    åº§æ¨™: "35.700, 140.800"
  },
  éœ‡åº¦åˆ†å¸ƒ: [
    { pref: "åƒè‘‰çœŒ", addr: "åƒè‘‰å¸‚", intensity: "3" },
    { pref: "æ±äº¬éƒ½", addr: "åƒä»£ç”°åŒº", intensity: "2" }
  ],
  æ´¥æ³¢æƒ…å ±: "æ´¥æ³¢ã«é–¢ã™ã‚‹æƒ…å ±ãŒç™ºè¡¨ã•ã‚Œã¦ã„ã¾ã™"
}
```

### 11.2 P2Pè¦–è¦šå¼·åŒ–æ©Ÿèƒ½

#### 11.2.1 ç·Šæ€¥åœ°éœ‡é€Ÿå ±ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
```css
.eew-status {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(10px);
  border-radius: 8px;
}
.eew-icon {
  animation: sparkle 3s infinite;
}
```

#### 11.2.2 æ´»å‹•çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
```javascript
// çµ±è¨ˆãƒ‡ãƒ¼ã‚¿æ§‹é€ 
dashboardStats: {
  todayCount: 0,      // ä»Šæ—¥ã®åœ°éœ‡æ•°
  weekCount: 0,       // ä»Šé€±ã®åœ°éœ‡æ•°  
  maxIntensity: '-',  // æœ€å¤§éœ‡åº¦
  activeRegions: '-', // æ´»ç™ºåœ°åŸŸæ•°
  lastActivity: null  // æœ€çµ‚æ´»å‹•æ™‚åˆ»
}
```

### 11.3 ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½æ‹¡å¼µ

#### 11.3.1 test.htmlæ–°æ©Ÿèƒ½
- **ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ†ã‚¹ãƒˆ**: `testModal()`é–¢æ•°ã§æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºãƒ†ã‚¹ãƒˆ
- **è©³ç´°ãƒ­ã‚°**: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œçµæœã®æ™‚ç³»åˆ—è¡¨ç¤º
- **åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ**: æ¥ç¶šã€é€šçŸ¥ã€éŸ³å£°ã€è¨­å®šã€åœ°éœ‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã€ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

### 11.4 å°†æ¥å®Ÿè£…äºˆå®šæ©Ÿèƒ½

#### 11.4.1 å¼·éœ‡ãƒ¢ãƒ‹ã‚¿çµ±åˆï¼ˆæœªå®Ÿè£…ï¼‰
- å¤–éƒ¨ã®å¼·éœ‡ãƒ¢ãƒ‹ã‚¿ã‚µã‚¤ãƒˆã¨ã®çµ±åˆæ©Ÿèƒ½
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éœ‡åº¦è¡¨ç¤ºãƒ‘ãƒãƒ«
- ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œã®æµ®å‹•ãƒ‘ãƒãƒ«

#### 11.4.2 é«˜åº¦æ´¥æ³¢äºˆæ¸¬ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆæœªå®Ÿè£…ï¼‰
- Mansinha-Smylieå¼ã«ã‚ˆã‚‹ç§‘å­¦çš„æ´¥æ³¢äºˆæ¸¬
- 18ç®‡æ‰€æ²¿å²¸éƒ¨ã¸ã®è©³ç´°äºˆæ¸¬è¨ˆç®—
- Green's Lawé©ç”¨ã®ç‰©ç†ãƒ™ãƒ¼ã‚¹è¨ˆç®—

#### 11.4.3 ç¾åœ¨ã®æ´¥æ³¢æ©Ÿèƒ½ã®åˆ¶é™äº‹é …
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ´¥æ³¢ç›£è¦–ã¯ç„¡åŠ¹ï¼ˆ`enableRealtime: false`ï¼‰
- è‡ªå‹•æ›´æ–°æ©Ÿèƒ½ã¯æœªå®Ÿè£…ï¼ˆæ‰‹å‹•æ›´æ–°ã®ã¿ï¼‰
- æ°—è±¡åºXMLçµ±åˆã¯CORSåˆ¶é™ã«ã‚ˆã‚Šéƒ¨åˆ†å®Ÿè£…
- æ´¥æ³¢äºˆæ¸¬è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ã¯å°†æ¥å®Ÿè£…äºˆå®š
- ç¾åœ¨ã¯åŸºæœ¬çš„ãªãƒªã‚¹ã‚¯è©•ä¾¡ã®ã¿æä¾›ï¼ˆ30%å®Œæˆï¼‰

## 12. çµ±åˆè¨­å®šãƒ‘ãƒãƒ«æŠ€è¡“ä»•æ§˜ (v2.0æ–°æ©Ÿèƒ½)

### 12.1 è¨­å®šãƒ‘ãƒãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### 12.1.1 å±•é–‹å¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ 
```javascript
// çµ±åˆè¨­å®šãƒ‘ãƒãƒ«æ§‹æˆ
const settingsPanel = {
    sections: [
        {
            id: 'activity-feed',
            title: 'ğŸ“‹ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ•ã‚£ãƒ¼ãƒ‰',
            collapsible: true,
            initialState: 'collapsed'
        },
        {
            id: 'brightness-settings', 
            title: 'ğŸ”† è¡¨ç¤ºèª¿æ•´',
            collapsible: true,
            initialState: 'collapsed'
        },
        {
            id: 'notification-settings',
            title: 'ğŸ”” é€šçŸ¥è¨­å®š', 
            collapsible: true,
            initialState: 'collapsed'
        }
    ]
};
```

#### 12.1.2 è¨­å®šã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°ä»•æ§˜

##### è¡¨ç¤ºèª¿æ•´è¨­å®š
```javascript
// æ˜åº¦èª¿æ•´è¨­å®š
const brightnessSettings = {
    mapBrightness: 100,         // 50-200% (ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã€10%åˆ»ã¿)
    autoNightMode: true,        // 18æ™‚-6æ™‚è‡ªå‹•é©ç”¨
    nightModeBrightness: 70,    // å¤œé–“ãƒ¢ãƒ¼ãƒ‰æ˜åº¦
    standardBrightness: 100     // æ¨™æº–è¡¨ç¤ºæ˜åº¦
};

// æ˜åº¦èª¿æ•´UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const brightnessComponents = {
    rangeSlider: 'mapBrightness (50-200%)',
    presetButtons: ['æš—ã‚(70%)', 'æ¨™æº–(100%)', 'æ˜ã‚‹ã‚(140%)'],
    headerToggle: 'ğŸŒ™å¤œé–“ãƒ¢ãƒ¼ãƒ‰ / â˜€ï¸æ¨™æº–è¡¨ç¤º',
    autoSave: 'localStorageé€£æº'
};
```

##### é€šçŸ¥è¨­å®š
```javascript
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šå€¤
const defaultSettings = {
    magnitudeThreshold: 4.0,    // M2.0-8.0 (ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼)
    intensityThreshold: 3,      // éœ‡åº¦1-5å¼±ä»¥ä¸Š (ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³)
    volume: 50,                 // 0-100% (ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼)
    autoZoom: true,            // boolean (ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒ)
    notifications: true         // boolean
};

// è¨­å®šUI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const settingComponents = {
    rangeSlider: 'magnitudeThreshold, volume',
    dropdown: 'intensityThreshold', 
    toggleSwitch: 'autoZoom',
    testButtons: 'testNotification(), testSound()'
};
```

### 12.2 è¨­å®šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

#### 12.2.1 LocalStorageé€£æº
```javascript
// è¨­å®šã®æ°¸ç¶šåŒ–
loadSettings() {
    const saved = localStorage.getItem('earthquake_settings');
    return saved ? {...defaultSettings, ...JSON.parse(saved)} : defaultSettings;
}

saveSettings() {
    localStorage.setItem('earthquake_settings', JSON.stringify(this.settings));
    this.addActivityFeedItem('ğŸ’¾', 'è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ', new Date());
}

updateSetting(key, value) {
    this.settings[key] = value;
    this.saveSettings();
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ UIæ›´æ–°
}
```

#### 12.2.2 ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½å®Ÿè£…
```javascript
// é€šçŸ¥ãƒ†ã‚¹ãƒˆ
testNotification() {
    if (Notification.permission === 'granted') {
        new Notification('ğŸŒ åœ°éœ‡ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ', {
            body: 'ãƒ†ã‚¹ãƒˆé€šçŸ¥ãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚\nM4.5 ãƒ†ã‚¹ãƒˆåœ°éœ‡ éœ‡åº¦3'
        });
    }
}

// éŸ³å£°ãƒ†ã‚¹ãƒˆ  
testSound() {
    const audioContext = new AudioContext();
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    // éŸ³é‡è¨­å®šã«åŸºã¥ãå†ç”Ÿ
    gainNode.gain.linearRampToValueAtTime(this.settings.volume / 100 * 0.3);
}
```

### 12.3 åœ°å›³è¡¨ç¤ºãƒ»æ˜åº¦èª¿æ•´ã‚·ã‚¹ãƒ†ãƒ 

#### 12.3.1 æ—¥æœ¬åˆ—å³¶ä½ç½®è¡¨ç¤º
```javascript
// ä¸»è¦éƒ½å¸‚ãƒãƒ¼ã‚«ãƒ¼ãƒ‡ãƒ¼ã‚¿
const japanCityMarkers = [
    { name: 'æœ­å¹Œ', coords: [43.064, 141.347], region: 'åŒ—æµ·é“' },
    { name: 'é’æ£®', coords: [40.824, 140.740], region: 'æ±åŒ—' },
    { name: 'ä»™å°', coords: [38.268, 140.872], region: 'æ±åŒ—' },
    { name: 'æ±äº¬', coords: [35.676, 139.650], region: 'é–¢æ±' },
    { name: 'æ–°æ½Ÿ', coords: [37.902, 139.023], region: 'ä¸­éƒ¨' },
    { name: 'åå¤å±‹', coords: [35.011, 136.768], region: 'ä¸­éƒ¨' },
    { name: 'å¤§é˜ª', coords: [34.693, 135.502], region: 'é–¢è¥¿' },
    { name: 'åºƒå³¶', coords: [34.396, 132.459], region: 'ä¸­å›½' },
    { name: 'é«˜æ¾', coords: [34.340, 134.043], region: 'å››å›½' },
    { name: 'ç¦å²¡', coords: [33.584, 130.401], region: 'ä¹å·' },
    { name: 'é¹¿å…å³¶', coords: [31.560, 130.558], region: 'ä¹å·' }
];

// ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥ãƒãƒ¼ã‚«ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«
const getJapanMarkerStyle = (layerName) => {
    const styles = {
        'ãƒ€ãƒ¼ã‚¯ï¼ˆæ§ãˆã‚ï¼‰': { radius: 3, fillColor: '#dddddd', color: '#ffffff' },
        'ã‚°ãƒ¬ãƒ¼ï¼ˆä¸­é–“èª¿ï¼‰': { radius: 3, fillColor: '#666666', color: '#333333' },
        'ãƒ©ã‚¤ãƒˆï¼ˆæ˜ã‚‹ã‚ï¼‰': { radius: 3, fillColor: '#333333', color: '#000000' },
        'æ¨™æº–ãƒãƒƒãƒ—': { radius: 3, fillColor: '#666666', color: '#333333' }
    };
    return styles[layerName] || styles['æ¨™æº–ãƒãƒƒãƒ—'];
};
```

#### 12.3.2 æ˜åº¦èª¿æ•´ã‚·ã‚¹ãƒ†ãƒ 
```javascript
// æ˜åº¦èª¿æ•´æ©Ÿèƒ½
class MapBrightnessController {
    constructor() {
        this.mapBrightness = 100; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ100%
        this.nightModeEnabled = false;
        this.initializeBrightnessSettings();
    }
    
    // æ˜åº¦é©ç”¨
    applyMapBrightness() {
        const mapContainer = document.querySelector('.leaflet-container');
        if (mapContainer && this.mapBrightness) {
            const brightness = this.mapBrightness / 100;
            mapContainer.style.filter = `brightness(${brightness})`;
        }
    }
    
    // å¤œé–“ãƒ¢ãƒ¼ãƒ‰çµ±åˆ
    enableNightMode(enabled) {
        const brightness = enabled ? 70 : 100; // å¤œé–“70%, æ¨™æº–100%
        this.updateMapBrightness(brightness);
        this.nightModeEnabled = enabled;
    }
    
    // è‡ªå‹•å¤œé–“ãƒ¢ãƒ¼ãƒ‰ï¼ˆ18-6æ™‚ï¼‰
    setupAutoNightMode() {
        const now = new Date();
        const hour = now.getHours();
        const isNightTime = hour >= 18 || hour < 6;
        this.enableNightMode(isNightTime);
    }
}
```

#### 12.3.3 UIé€£æºã‚·ã‚¹ãƒ†ãƒ 
```javascript
// ãƒ˜ãƒƒãƒ€ãƒ¼ãƒœã‚¿ãƒ³ã¨è¨­å®šãƒ‘ãƒãƒ«ã®é€£æº
const brightnessUISync = {
    headerButton: 'ğŸŒ™å¤œé–“ãƒ¢ãƒ¼ãƒ‰ / â˜€ï¸æ¨™æº–è¡¨ç¤º',
    settingsSlider: 'map-brightness-slider (50-200%)',
    presetButtons: ['æš—ã‚(70%)', 'æ¨™æº–(100%)', 'æ˜ã‚‹ã‚(140%)'],
    autoSave: 'localStorage.mapBrightness',
    realTimeSync: 'updateMapBrightness() â†’ UIæ›´æ–°'
};
```

## 13. å®Ÿè£…å®Œäº†æ©Ÿèƒ½ä¸€è¦§ (80%é”æˆ)

### 13.1 å®Œå…¨å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½
- âœ… **çµ±åˆè¨­å®šãƒ‘ãƒãƒ«**: 3ã‚»ã‚¯ã‚·ãƒ§ãƒ³å±•é–‹å¼UI
- âœ… **è©³ç´°é€šçŸ¥è¨­å®š**: ãƒã‚°ãƒ‹ãƒãƒ¥ãƒ¼ãƒ‰ãƒ»éœ‡åº¦é–¾å€¤ã€éŸ³é‡ã€è‡ªå‹•ã‚ºãƒ¼ãƒ 
- âœ… **è¨­å®šæ°¸ç¶šåŒ–**: LocalStorageé€£æºãƒ»è‡ªå‹•ä¿å­˜
- âœ… **ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½**: é€šçŸ¥ãƒ»éŸ³å£°ãƒ†ã‚¹ãƒˆå®Œå‚™
- âœ… **ç·Šæ€¥åœ°éœ‡é€Ÿå ±å¯¾å¿œ**: EEWã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºãƒ»ç›£è¦–
- âœ… **ãƒ¢ãƒ¼ãƒ€ãƒ«è©³ç´°è¡¨ç¤º**: ã‚¯ãƒªãƒƒã‚¯æ™‚ã®è©³ç´°æƒ…å ±è¡¨ç¤º
- âœ… **æ´»å‹•çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆè¡¨ç¤º
- âœ… **10ä»¶å±¥æ­´è¡¨ç¤º**: è¡¨ç¤ºä»¶æ•°ã®æ‹¡å¼µ
- âœ… **è¦–è¦šçš„UIå¼·åŒ–**: Glassmorphismã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
- âœ… **åœ°å›³ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†**: è¤‡æ•°ãƒ†ãƒ¼ãƒå¯¾å¿œãƒ»è¨­å®šçµ±åˆ

### 13.2 ä»Šå¾Œã®æ©Ÿèƒ½æ‹¡å¼µ
- **PWAåŒ–**: Service Workerã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ
- **åœ°åŸŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½ç½®æƒ…å ±ãƒ™ãƒ¼ã‚¹
- **ã‚«ã‚¹ã‚¿ãƒ é€šçŸ¥éŸ³**: éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- **WebSocketãƒ†ã‚¹ãƒˆ**: æ–°è¦è¿½åŠ å®Œäº†ï¼ˆwebsocket-test.htmlï¼‰

### 13.3 æŠ€è¡“æ”¹å–„
- **TypeScriptåŒ–**: å‹å®‰å…¨æ€§ã®å‘ä¸Š
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²**: ES6 Modulesä½¿ç”¨
- **ãƒ†ã‚¹ãƒˆå°å…¥**: Jestç­‰ã§ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

## 13. ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´° v2.0

### 13.1 Component-based ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### 13.1.1 EventBus ã‚·ã‚¹ãƒ†ãƒ 
```javascript
// ä¸­å¤®ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
class EventBus {
    constructor() {
        this.events = new Map();
        this.onceEvents = new Map();
    }
    
    subscribe(event, callback, context = null)  // ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­
    publish(event, data)                        // ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
    once(event, callback, context = null)       // ä¸€å›é™ã‚Šã®è³¼èª­
    clear(event = null)                         // ã‚¤ãƒ™ãƒ³ãƒˆã‚¯ãƒªã‚¢
}
```

#### 13.1.2 BaseComponent ã‚¯ãƒ©ã‚¹
```javascript
// å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åŸºåº•ã‚¯ãƒ©ã‚¹
class BaseComponent {
    constructor(container, options = {}) {
        this.container = container;
        this.options = { ...this.defaultOptions, ...options };
        this.eventBus = eventBus;
        this.element = null;
        this.isInitialized = false;
        this.isDestroyed = false;
    }
    
    // ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰
    async init()              // åˆæœŸåŒ–å‡¦ç†
    async render()            // DOMè¦ç´ ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    async setupEventListeners() // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
    async update(data)        // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ›´æ–°
    destroy()                 // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç ´æ£„
    
    // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ¡ã‚½ãƒƒãƒ‰
    subscribeToEvent(event, callback)
    addEventListener(element, event, callback)
    createElement(tag, classes, attributes)
    createFromTemplate(template, data)
}
```

#### 13.1.3 P2PPanel ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```javascript
// P2Påœ°éœ‡æƒ…å ±è¡¨ç¤ºãƒ‘ãƒãƒ«
class P2PPanel extends BaseComponent {
    constructor(container, options = {}) {
        super(container, options);
        this.connectionStatus = 'disconnected';
        this.dashboardStats = {
            todayCount: 0,
            weekCount: 0,
            maxIntensity: '-',
            activeRegions: '-',
            responseTime: 0,
            dataPackets: 0
        };
        this.activityFeed = [];
        this.eewStatus = { isActive: false, message: 'ç™ºä¿¡ãªã—' };
    }
    
    // ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰
    handleEarthquakeDetected(earthquake)  // åœ°éœ‡æ¤œå‡ºå‡¦ç†
    handleEEW(eewData)                   // ç·Šæ€¥åœ°éœ‡é€Ÿå ±å‡¦ç†
    updateStatistics(earthquake)         // çµ±è¨ˆæƒ…å ±æ›´æ–°
    addActivityFeedItem(item)           // æ´»å‹•ãƒ•ã‚£ãƒ¼ãƒ‰è¿½åŠ 
    updateDashboard()                   // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
}
```

#### 13.1.4 Earthquake ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
```javascript
// å³å¯†ãªåœ°éœ‡ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
class Earthquake {
    constructor(rawData, source = 'unknown') {
        this.id = this.generateId(rawData, source);
        this.source = source;
        this.timestamp = this.parseTimestamp(rawData.time);
        this.magnitude = parseFloat(rawData.magnitude) || null;
        this.depth = parseInt(rawData.depth) || null;
        this.location = rawData.location || '';
        this.coordinates = this.parseCoordinates(rawData);
        this.maxIntensity = this.parseMaxIntensity(rawData);
        this.intensityPoints = this.parseIntensityPoints(rawData);
        this.tsunami = this.parseTsunamiInfo(rawData);
        this.validate(); // ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
    }
    
    // æ¤œè¨¼ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ»å¤‰æ›ãƒ¡ã‚½ãƒƒãƒ‰
    validate()                    // ãƒ‡ãƒ¼ã‚¿å¦¥å½“æ€§æ¤œè¨¼
    formatTime(format = 'full')   // æ™‚åˆ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    formatMagnitude()             // ãƒã‚°ãƒ‹ãƒãƒ¥ãƒ¼ãƒ‰è¡¨ç¤º
    toGeoJSON()                   // GeoJSONå¤‰æ›
    toJSON()                      // JSONå¤‰æ›
    static fromJSON(json)         // JSONå¾©å…ƒ
}
```

### 13.2 ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«æ©Ÿèƒ½å®Ÿè£…

#### 13.2.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
```javascript
// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
startPerformanceMonitoring() {
    setInterval(() => {
        // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–
        if (performance.memory) {
            this.performanceMetrics.memoryUsage = Math.round(
                performance.memory.usedJSHeapSize / 1024 / 1024
            );
            
            // é–¾å€¤è¶…éæ™‚ã®è­¦å‘Š
            if (this.performanceMetrics.memoryUsage > 100) {
                console.warn(`âš ï¸ High memory usage: ${this.performanceMetrics.memoryUsage}MB`);
                this.eventBus.publish('app.performance.warning', {
                    type: 'memory',
                    value: this.performanceMetrics.memoryUsage
                });
            }
        }
        
        // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå¥å…¨æ€§ãƒã‚§ãƒƒã‚¯
        this.componentInstances.forEach(component => {
            if (component.isDestroyed) {
                console.warn('âš ï¸ Destroyed component found:', component.id);
            }
        });
    }, 30000); // 30ç§’ã”ã¨
}
```

#### 13.2.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```javascript
// åŒ…æ‹¬çš„ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ 
handleComponentError(errorData) {
    console.error(`âŒ Component error in ${errorData.id}:`, errorData.error);
    
    // ã‚¨ãƒ©ãƒ¼çµ±è¨ˆæ›´æ–°
    this.performanceMetrics.errorCount = (this.performanceMetrics.errorCount || 0) + 1;
    
    // ã‚¨ãƒ©ãƒ¼å¾©æ—§å‡¦ç†
    if (errorData.type === 'connection') {
        this.attemptReconnection();
    }
}

handleWebSocketError(error) {
    console.error('âŒ WebSocket Error:', error);
    this.eventBus.publish('api.error', { type: 'websocket', error });
    
    // è‡ªå‹•å†æ¥ç¶šï¼ˆæœ€å¤§3å›ï¼‰
    if (this.reconnectAttempts < 3) {
        setTimeout(() => {
            this.reconnectAttempts++;
            this.connectWebSocket();
        }, 5000 * this.reconnectAttempts);
    }
}
```

#### 13.2.3 ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
```javascript
// LocalStorageæ´»ç”¨ã®é«˜åº¦ãªãƒ‡ãƒ¼ã‚¿ç®¡ç†
saveData() {
    try {
        // è¨­å®šã®ä¿å­˜
        localStorage.setItem('earthquake_app_settings', JSON.stringify(this.settings));
        
        // å±¥æ­´ã®ä¿å­˜ï¼ˆæœ€æ–°100ä»¶ã®ã¿ï¼‰
        const historyToSave = this.earthquakeHistory
            .slice(0, this.settings.performance.maxHistoryItems)
            .map(earthquake => earthquake.toJSON());
        
        localStorage.setItem('earthquake_history', JSON.stringify(historyToSave));
        
        // ä¿å­˜å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆ
        this.eventBus.publish('app.data.saved', {
            settingsSize: JSON.stringify(this.settings).length,
            historySize: historyToSave.length
        });
        
    } catch (error) {
        console.error('âŒ Failed to save data:', error);
        this.eventBus.publish('app.error', { error, phase: 'save' });
    }
}
```

### 13.2 æŠ€è¡“çš„é”æˆåº¦

| æ©Ÿèƒ½ã‚«ãƒ†ã‚´ãƒª | å®Œæˆåº¦ | å®Ÿè£…è©³ç´° |
|-------------|--------|----------|
| çµ±åˆè¨­å®šã‚·ã‚¹ãƒ†ãƒ  | 100% | 3ã‚»ã‚¯ã‚·ãƒ§ãƒ³å±•é–‹å¼ãƒ»LocalStorageé€£æº |
| é€šçŸ¥ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ  | 100% | ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥ãƒ»éŸ³å£°ãƒ»é–¾å€¤è¨­å®šãƒ»ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦– | 100% | WebSocket APIãƒ»å±¥æ­´APIãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° |
| UI/UXã‚·ã‚¹ãƒ†ãƒ  | 95% | ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– |
| åœ°å›³ãƒ»å¯è¦–åŒ– | 95% | è¤‡æ•°ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ»éœ‡æºãƒãƒ¼ã‚«ãƒ¼ãƒ»è‡ªå‹•ã‚ºãƒ¼ãƒ  |
| ãƒ‡ãƒ¼ã‚¿ç®¡ç† | 90% | LocalStorageãƒ»å±¥æ­´ç®¡ç†ãƒ»çµ±è¨ˆè¨ˆç®— |

**ç·åˆæŠ€è¡“çš„å®Œæˆåº¦: 80%** (ç›®æ¨™é”æˆ)

## 14. æ´¥æ³¢äºˆå ±åŒºå®Ÿè£…æŠ€è¡“ä»•æ§˜

### 14.1 JMAæ´¥æ³¢ãƒ‡ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ 

#### 14.1.1 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
```
æ°—è±¡åºShapefile (89MB) â†’ GeoJSONå¤‰æ› â†’ TopoJSONæœ€é©åŒ– (1.5MB) â†’ ãƒ–ãƒ©ã‚¦ã‚¶è¡¨ç¤º
```

#### 14.1.2 ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
- **jma-tsunami-loader.js**: è£½å“ç‰ˆTopoJSONãƒ­ãƒ¼ãƒ€ãƒ¼
  - ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
  - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ 
- **jma-data-converter.js**: é–‹ç™ºç”¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
  - Shapefile â†’ GeoJSON â†’ TopoJSONå¤‰æ›ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- **data/jma-tsunami-areas.topojson**: 14æ´¥æ³¢äºˆå ±åŒºãƒ‡ãƒ¼ã‚¿ (23KB)

#### 14.1.3 æŠ€è¡“çš„åˆ¶é™
```javascript
// æŠ€è¡“çš„é™ç•Œ
const limitations = {
    displayQuality: 'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆãƒ©ã‚¤ãƒ³è¿‘ä¼¼ï¼ˆæ›²ç·šè¡¨ç¤ºä¸å¯ï¼‰',
    dataSource: 'é™çš„TopoJSONãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ãªã—ï¼‰',
    visualComparison: 'NHK/KyoshinEewViewerã®å“è³ªã«åŠ£ã‚‹',
    webTechLimit: 'WebæŠ€è¡“ã«ã‚ˆã‚‹åœ°ç†çš„ç²¾åº¦ã®åˆ¶ç´„'
};
```

#### 14.1.4 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä»•æ§˜
```javascript
// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
const performance = {
    fileSize: '23KB (95%å‰Šæ¸›)', 
    loadTime: '50-100mså¹³å‡',
    memoryUsage: '+5-10MB',
    cacheStrategy: 'LocalStorage + ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥',
    errorHandling: 'ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ + è‡ªå‹•å¾©æ—§'
};
```

#### 14.1.5 JMAå…¬å¼ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
```javascript
// TopoJSON ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä»•æ§˜
const jmaProperties = {
    AREA_NAME: 'åŒ—æµ·é“å¤ªå¹³æ´‹æ²¿å²¸æ±éƒ¨',    // äºˆå ±åŒºå
    AREA_CODE: '191',                    // æ°—è±¡åºåœ°åŸŸã‚³ãƒ¼ãƒ‰
    STATUS: 'advisory',                  // è­¦å ±ãƒ¬ãƒ™ãƒ«
    WAVE_HEIGHT: '1m',                   // äºˆæƒ³æ´¥æ³¢é«˜
    ARRIVAL_TIME: 'æ—¢ã«åˆ°é”ã¨æ¨å®š'        // åˆ°é”äºˆæƒ³æ™‚åˆ»
};
```

### 14.2 å®Ÿè£…ã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

#### 14.2.1 ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–
```javascript
class JMADataConverter {
    // 89MB â†’ 1.5MBå¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹
    optimize(shapefileData) {
        return topojson.topology({
            tsunami_areas: geoJsonData
        }, {
            quantization: 10000,  // åº§æ¨™ç²¾åº¦
            'simplify-ratio': 0.1  // å½¢çŠ¶ç°¡ç•¥åŒ–
        });
    }
}
```

#### 14.2.2 è¡¨ç¤ºåˆ¶å¾¡
```javascript
// æ´¥æ³¢è­¦å ±ãƒ¬ãƒ™ãƒ«åˆ¥è‰²åˆ†ã‘
const TSUNAMI_COLORS = {
    advisory: '#FFD700',      // æ´¥æ³¢æ³¨æ„å ±: é»„è‰²
    warning: '#FF8C00',       // æ´¥æ³¢è­¦å ±: ã‚ªãƒ¬ãƒ³ã‚¸
    major_warning: '#FF4500'  // å¤§æ´¥æ³¢è­¦å ±: èµ¤
};
```

### 14.3 åˆ¶é™äº‹é …ã¨ä»Šå¾Œã®èª²é¡Œ

#### 14.3.1 æŠ€è¡“çš„åˆ¶é™
1. **è¡¨ç¤ºå“è³ª**: ç›´ç·šè¿‘ä¼¼ã«ã‚ˆã‚‹æ²¿å²¸æ›²ç·šã®ç²¾åº¦ä¸è¶³
2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§**: P2Påœ°éœ‡æƒ…å ±ã«æ´¥æ³¢ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œãªã„
3. **å°‚é–€ã‚½ãƒ•ãƒˆã¨ã®æ ¼å·®**: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åŠ£ã‚‹è¦–è¦šå“è³ª

#### 14.3.2 WebæŠ€è¡“ã®é™ç•Œ
- ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ€§èƒ½ã«ã‚ˆã‚‹åˆ¶ç´„
- JavaScriptã§ã®åœ°ç†ãƒ‡ãƒ¼ã‚¿å‡¦ç†é™ç•Œ
- TopoJSONç°¡ç•¥åŒ–ã«ã‚ˆã‚‹è©³ç´°ã®æ¬ è½

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ  v3.1

### æ–°è¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```javascript
// TimerManager - ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯å¯¾ç­–
class TimerManager {
    setInterval(callback, delay, options)  // å®‰å…¨ãªsetInterval
    setTimeout(callback, delay, options)   // å®‰å…¨ãªsetTimeout
    clearTimer(timerId)                   // çµ±ä¸€ã‚¿ã‚¤ãƒãƒ¼ã‚¯ãƒªã‚¢
    clearAllTimers()                      // å…¨ã‚¿ã‚¤ãƒãƒ¼ä¸€æ‹¬ã‚¯ãƒªã‚¢
}

// ErrorHandler - çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
class ErrorHandler {
    handleError(level, message, details, context)  // çµ±ä¸€ã‚¨ãƒ©ãƒ¼å‡¦ç†
    info/warn/error/fatal(message, details)       // ãƒ¬ãƒ™ãƒ«åˆ¥ãƒ­ã‚°
    showUserNotification(errorEntry)              // ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥
}

// DataValidator - ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼å¼·åŒ–
class DataValidator {
    validate(data, schemaType, options)    // ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼
    detectAnomalies(data, schemaType)     // ç•°å¸¸å€¤æ¤œå‡º
    sanitizeData(data, schemaType)        // ãƒ‡ãƒ¼ã‚¿ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
}

// AppConfig - çµ±ä¸€è¨­å®šç®¡ç†
class AppConfig {
    get(path, defaultValue)               // è¨­å®šå€¤å–å¾—
    set(path, value)                      // è¨­å®šå€¤è¨­å®š
    addConfigListener(path, callback)     // è¨­å®šå¤‰æ›´ç›£è¦–
}

// Utils - å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
class Utils {
    formatDateTime/Number/Intensity()     // ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå‡¦ç†
    createElement(tag, options)           // å®‰å…¨ãªDOMä½œæˆ
    deepClone/Merge(obj)                 // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ
}
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–å®Ÿè£…çŠ¶æ³
- âœ… **XSSè„†å¼±æ€§å¯¾ç­–**: innerHTML â†’ textContent/createElement
- âœ… **å¤–éƒ¨ãƒ—ãƒ­ã‚­ã‚·å»ƒæ­¢**: è‡ªå‰ãƒ—ãƒ­ã‚­ã‚·ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- âœ… **CSPå³æ ¼åŒ–**: unsafe-inline/unsafe-evalå‰Šé™¤
- âœ… **ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯å¯¾ç­–**: TimerManagerçµ±ä¸€ç®¡ç†
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€**: ErrorHandleråŒ…æ‹¬å‡¦ç†
- âœ… **ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼å¼·åŒ–**: ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ãƒ»ç•°å¸¸å€¤æ¤œå‡º
- âœ… **è¨­å®šç®¡ç†çµ±ä¸€**: AppConfigä¸€å…ƒç®¡ç†
- âœ… **ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Š**: Utilsé‡è¤‡æ’é™¤

---

**æœ€çµ‚æ›´æ–°**: 2024å¹´12æœˆ19æ—¥  
**å®Œæˆåº¦**: **60%é”æˆ** (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–å®Œäº†)  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.1.0 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ç‰ˆæ´¥æ³¢ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ   
**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ– + Professional Component-based Design  
**æŠ€è¡“ä»•æ§˜**: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¬ãƒ™ãƒ«å®Ÿè£…å®Œäº† + ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–å®Œå‚™  
**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: XSSå¯¾ç­–ãƒ»CSPå³æ ¼åŒ–ãƒ»ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯å¯¾ç­–ãƒ»çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°  
**æ´¥æ³¢å®Ÿè£…**: é«˜ç²¾åº¦äºˆæ¸¬ã‚¨ãƒ³ã‚¸ãƒ³ + ç·Šæ€¥å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ å®Œå‚™  
**éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ **: Web Audio APIå®Œå…¨å®Ÿè£…ãƒ»å¤–éƒ¨ä¾å­˜æ€§é™¤å»  
**CORSå¯¾å¿œ**: ã‚»ã‚­ãƒ¥ã‚¢ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼å®Œå…¨å®Ÿè£…